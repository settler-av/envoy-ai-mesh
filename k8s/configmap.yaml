apiVersion: v1
kind: ConfigMap
metadata:
  name: nginx-plugin-config
  namespace: default
  labels:
    app: nginx-sidecar-proxy
data:
  config.yaml: |
    - name: "SQLSanitizer"
      kind: "plugins.sql_sanitizer"
      hooks: ["tool_pre_invoke"]
      mode: "enforce"
      priority: 40
      config:
        fields: ["sql", "query", "statement"]  # null = scan all string args
        strip_comments: true
        block_delete_without_where: true
        block_update_without_where: true
        require_parameterization: false
        blocked_statements: ["\\bDROP\\b", "\\bTRUNCATE\\b", "\\bALTER\\b"]
        block_on_violation: true
    
    - name: "PIIGuard"
      kind: "plugins.pii"
      hooks: ["tool_pre_invoke", "prompt_pre_fetch"]
      mode: "monitor"
      priority: 10
      config: {}

